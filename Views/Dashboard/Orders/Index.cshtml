@model List<OnlineStoreMVC.Models.ViewModels.OrderManageViewModel>
@using OnlineStoreMVC.Helpers

@{
  Layout = "~/Views/Shared/_DashboardLayout.cshtml";
  ViewData["Title"] = "Qu·∫£n l√Ω ƒë∆°n h√†ng";
}

<div class="d-flex justify-content-between align-items-center mb-3">
  <h2>üßæ Danh s√°ch ƒë∆°n h√†ng</h2>
  <a class="btn btn-success" href="/Dashboard/Orders/Create">‚ûï T·∫°o m·ªõi</a>
</div>

<table class="table table-bordered table-hover">
  <thead class="table-dark">
    <tr>
      <th>#</th>
      <th>Ng∆∞·ªùi ƒë·∫∑t</th>
      <th>Ng√†y ƒë·∫∑t</th>
      <th>Tr·∫°ng th√°i</th>
      <th>T·ªïng ti·ªÅn</th>
      <th>Thao t√°c</th>
    </tr>
  </thead>
  <tbody>
    @for (int i = 0; i < Model.Count; i++)
    {
      var order = Model[i];
      <tr>
        <td>@(i + 1)</td>
        <td>@order.UserName</td>
        <td>@order.OrderDate.ToString("dd/MM/yyyy HH:mm")</td>
        <td>@order.Status</td>
        <td>@order.TotalAmount.ToString("N0") ‚Ç´</td>
        <td>
          <a class="btn btn-sm btn-primary" href="/Dashboard/Orders/Edit/@order.OrderID">S·ª≠a</a>
          <form asp-action="Delete" asp-route-id="@order.OrderID" method="post" style="display:inline;"
            onsubmit="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a ƒë∆°n h√†ng n√†y?');">
            <button type="submit" class="btn btn-sm btn-danger">X√≥a</button>
          </form>
        </td>
      </tr>
      <tr>
        <td colspan="6">
          <div class="bg-light p-2 rounded">
            <strong>Chi ti·∫øt ƒë∆°n h√†ng:</strong>
            <table class="table table-sm table-striped mt-2">
              <thead>
                <tr>
                  <th>S·∫£n ph·∫©m</th>
                  <th>S·ªë l∆∞·ª£ng</th>
                  <th>ƒê∆°n gi√°</th>
                  <th>Th√†nh ti·ªÅn</th>
                </tr>
              </thead>
              <tbody>
                @foreach (var item in order.Items)
                {
                  <tr>
                    <td>@item.ProductName</td>
                    <td>@item.Quantity</td>
                    <td>@FormatHelper.FormatCurrency(item.UnitPrice)</td>
                    <td>@FormatHelper.FormatCurrency(item.Quantity * item.UnitPrice)</td>
                  </tr>
                }
              </tbody>
            </table>
          </div>
        </td>
      </tr>
    }
  </tbody>
</table>