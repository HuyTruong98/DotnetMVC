@model OnlineStoreMVC.Models.ViewModels.ProductViewModel
@using OnlineStoreMVC.Models

@{
  Layout = "~/Views/Shared/_DashboardLayout.cshtml";
  ViewData["Title"] = "Chỉnh sửa sản phẩm";
}

<div class="d-flex justify-content-center mt-5">
  <div class="card shadow" style="width: 800px;">
    <div class="card-header bg-warning text-dark">
      <h4 class="mb-0">✏️ Chỉnh sửa sản phẩm</h4>
    </div>

    <div class="card-body">
      @Html.ValidationSummary(true, "", new { @class = "text-danger" })

      <form asp-action="Edit" asp-route-id="@Model.ProductID" method="post" enctype="multipart/form-data">
        <div class="mb-3">
          <label asp-for="ProductName" class="form-label">Tên</label>
          <input asp-for="ProductName" class="form-control" />
          <span asp-validation-for="ProductName" class="text-danger"></span>
        </div>

        <div class="mb-3">
          <label asp-for="Price" class="form-label">Giá</label>
          <input class="form-control" type="text" name="Price"
            value="@(Model.Price.HasValue? Model.Price.Value.ToString("0") : "")"
            oninput="this.value = this.value.replace(/[^0-9]/g, '')" />
          <span asp-validation-for="Price" class="text-danger"></span>
        </div>

        <div class="mb-3">
          <label asp-for="Stock" class="form-label">Tồn kho</label>
          <input asp-for="Stock" class="form-control" type="text"
            oninput="this.value = this.value.replace(/[^0-9]/g, '')" />
          <span asp-validation-for="Stock" class="text-danger"></span>
        </div>

        <div class="mb-3">
          <label asp-for="CategoryID" class="form-label">Loại</label>
          <select asp-for="CategoryID" class="form-select" asp-items="ViewBag.Categories">
            <option value="">-- Chọn danh mục --</option>
          </select>
          <span asp-validation-for="CategoryID" class="text-danger"></span>
        </div>

        <div class="mb-3">
          <label asp-for="Status" class="form-label">Trạng thái</label>
          <select asp-for="Status" class="form-select">
            <option value="Available">Có sẵn</option>
            <option value="OutOfStock">Hết hàng</option>
            <option value="Promotion">Khuyến mãi</option>
          </select>
          <span asp-validation-for="Status" class="text-danger"></span>
        </div>

        <div class="mb-3">
          <label class="form-label">Ảnh hiện tại</label>
          <div class="d-flex flex-wrap gap-2">
            @{
              var images = ViewBag.ExistingImages as IEnumerable<ProductImage>;
            }

            @if (images != null && images.Any())
            {
              foreach (var img in images)
              {
                <img src="@img.ImageURL" width="100" />
              }
            }

          </div>
        </div>

        <div class="mb-3">
          <label class="form-label">Thay ảnh mới (nếu muốn)</label>
          <input type="file" name="Images" multiple class="form-control" />
        </div>

        <div class="mb-3 form-check">
          <input asp-for="IsFeatured" class="form-check-input" type="checkbox" />
          <label asp-for="IsFeatured" class="form-check-label">Sản Phẩm Nổi bật</label>
          <span asp-validation-for="IsFeatured" class="text-danger"></span>
        </div>


        <div class="mb-3">
          <label asp-for="Description" class="form-label">Ghi chú</label>
          <textarea asp-for="Description" class="form-control" rows="3"></textarea>
          <span asp-validation-for="Description" class="text-danger"></span>
        </div>

        <button type="submit" class="btn btn-warning">Cập nhật</button>
        <a href="/Dashboard/Products" class="btn btn-secondary ms-2">Quay lại</a>
      </form>
    </div>
  </div>
</div>

@section Scripts {
  <partial name="_ValidationScriptsPartial" />
}