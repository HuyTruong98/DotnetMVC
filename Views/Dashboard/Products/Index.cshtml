@model List<OnlineStoreMVC.Models.Product>
@using OnlineStoreMVC.Helpers

@{
  Layout = "~/Views/Shared/_DashboardLayout.cshtml";
  ViewData["Title"] = "Qu·∫£n l√Ω s·∫£n ph·∫©m";
}

<div class="d-flex justify-content-between align-items-center mb-3">
  <h2>üì¶ Danh s√°ch s·∫£n ph·∫©m</h2>
  <a class="btn btn-success" href="/Dashboard/Products/Create">‚ûï T·∫°o m·ªõi</a>
</div>

<table class="table table-bordered table-hover">
  <thead class="table-dark">
    <tr>
      <th>#</th>
      <th>·∫¢nh</th>
      <th>T√™n s·∫£n ph·∫©m</th>
      <th>Lo·∫°i</th>
      <th>Gi√°</th>
      <th>T·ªìn kho</th>
      <th>Tr·∫°ng th√°i</th>
      <th>Ng√†y t·∫°o</th>
      <th>Thao t√°c</th>
    </tr>
  </thead>
  <tbody>
    @for (int i = 0; i < Model.Count; i++)
    {
      var product = Model[i];
      var primaryImage = product.ProductImages.FirstOrDefault(img => img.IsPrimary) ??
      product.ProductImages.FirstOrDefault();

      string badgeClass = product.Status switch
      {
        "Available" => "bg-success",
        "OutOfStock" => "bg-danger",
        "Promotion" => "bg-warning text-dark",
        _ => "bg-secondary"
      };

      <tr>
        <td>@(i + 1)</td>
        <td>
          @if (primaryImage != null)
          {
            <img src="@primaryImage.ImageURL" width="80" class="img-thumbnail" />
          }
          else
          {
            <span class="text-muted">Kh√¥ng c√≥ ·∫£nh</span>
          }
        </td>
        <td>@product.ProductName</td>
        <td>@product.Category?.CategoryName</td>
        <td>@FormatHelper.FormatCurrency(product.Price)</td>
        <td>@product.Stock</td>
        <td><span class="badge @badgeClass">@product.Status</span></td>
        <td>@FormatHelper.FormatDate(product.CreatedAt)</td>
        <td>
            <a class="btn btn-sm btn-primary" href="/Dashboard/Products/Details/@product.ProductID">Chi Ti·∫øt</a>
            <a class="btn btn-sm btn-primary" href="/Dashboard/Products/Edit/@product.ProductID">S·ª≠a</a>
            <a class="btn btn-sm btn-danger" href="/Dashboard/Products/Delete/@product.ProductID"
               onclick="return confirm('B·∫°n c√≥ ch·∫Øc mu·ªën x√≥a s·∫£n ph·∫©m n√†y?');">X√≥a</a>

        </td>
      </tr>
    }
  </tbody>
</table>